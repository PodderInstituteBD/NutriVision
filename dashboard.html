{% extends "base.html" %}

{% block content %}
<div class="grid grid-cols-1 lg:grid-cols-3 gap-10">
    <div class="lg:col-span-2 space-y-10">
        <!-- Dashboard Header -->
        <div class="glass-card rounded-[2.5rem] p-10">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-10 gap-6">
                <div>
                    <h2 class="text-4xl font-black text-gray-900 tracking-tight">Welcome, {{ user_name }}</h2>
                    <p class="text-gray-500 font-bold mt-1">Mode: <span class="text-emerald-600 uppercase">{{ diet_mode|replace('_', ' ') }}</span></p>
                </div>
                <div class="flex items-center gap-4">
                    <div class="flex flex-col items-end">
                        <span class="text-[10px] font-black uppercase text-emerald-600 tracking-tighter">Status</span>
                        <span class="px-5 py-2 bg-emerald-100 text-emerald-700 rounded-2xl text-sm font-black">
                            {{ bmi_category }}
                        </span>
                    </div>
                    <div class="flex flex-col items-end">
                        <span class="text-[10px] font-black uppercase text-blue-600 tracking-tighter">BMI</span>
                        <span class="px-5 py-2 bg-blue-100 text-blue-700 rounded-2xl text-sm font-black">
                            {{ bmi }}
                        </span>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-12">
                <div class="p-8 rounded-[2rem] bg-emerald-50/50 border border-emerald-100">
                    <p class="text-emerald-600 text-xs font-black uppercase tracking-widest mb-2">Daily Goal</p>
                    <p class="text-4xl font-black text-gray-900">{{ daily_cal }} <span class="text-sm font-bold text-gray-400">kcal</span></p>
                </div>
                <div class="p-8 rounded-[2rem] bg-blue-50/50 border border-blue-100">
                    <p class="text-blue-600 text-xs font-black uppercase tracking-widest mb-2">Consumed</p>
                    <p class="text-4xl font-black text-gray-900">{{ total_cal }} <span class="text-sm font-bold text-gray-400">kcal</span></p>
                </div>
                <div class="p-8 rounded-[2rem] bg-amber-50/50 border border-amber-100">
                    <p class="text-amber-600 text-xs font-black uppercase tracking-widest mb-2">Remaining</p>
                    <p class="text-4xl font-black text-gray-900">{{ remaining }} <span class="text-sm font-bold text-gray-400">kcal</span></p>
                </div>
            </div>

            <div class="space-y-5 mb-12">
                <div class="flex justify-between items-end px-1">
                    <p class="font-black text-gray-800 text-lg">Daily Progress</p>
                    <p class="text-emerald-600 font-black text-2xl">{{ progress_percent }}%</p>
                </div>
                <div class="w-full bg-gray-100 rounded-full h-5 p-1">
                    <div class="bg-gradient-to-r from-emerald-400 to-emerald-600 h-full rounded-full animate-progress shadow-lg shadow-emerald-200"
                         style="width: {{ progress_percent }}%">
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-3 gap-6 bg-gray-50/50 p-8 rounded-[2rem]">
                <div class="text-center">
                    <p class="text-gray-400 text-[10px] font-black uppercase tracking-widest mb-2">Protein</p>
                    <p class="text-2xl font-black text-gray-900">{{ totals.protein }}<span class="text-xs ml-1 text-gray-400">g</span></p>
                </div>
                <div class="text-center">
                    <p class="text-gray-400 text-[10px] font-black uppercase tracking-widest mb-2">Carbs</p>
                    <p class="text-2xl font-black text-gray-900">{{ totals.carbs }}<span class="text-xs ml-1 text-gray-400">g</span></p>
                </div>
                <div class="text-center">
                    <p class="text-gray-400 text-[10px] font-black uppercase tracking-widest mb-2">Fat</p>
                    <p class="text-2xl font-black text-gray-900">{{ totals.fat }}<span class="text-xs ml-1 text-gray-400">g</span></p>
                </div>
            </div>
        </div>

        <!-- Food Log -->
        <div class="glass-card rounded-[2.5rem] p-10">
            <div class="flex justify-between items-center mb-8">
                <h3 class="text-2xl font-black text-gray-900 tracking-tight">Food Log</h3>
                <a href="{{ url_for('food_entry') }}" class="bg-emerald-600 text-white px-8 py-3 rounded-2xl font-black text-sm hover:shadow-lg transition-all">Add Meal</a>
            </div>

            {% if food_log %}
            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead>
                        <tr class="text-gray-400 text-[10px] font-black uppercase tracking-[0.2em] border-b border-gray-100">
                            <th class="pb-6 text-left">Food Name</th>
                            <th class="pb-6 text-center">Calories</th>
                            <th class="pb-6 text-center">P</th>
                            <th class="pb-6 text-center">C</th>
                            <th class="pb-6 text-center">F</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-50">
                        {% for item in food_log %}
                        <tr>
                            <td class="py-6 font-black text-gray-800 capitalize">{{ item.name }}</td>
                            <td class="py-6 text-center font-black text-emerald-600">{{ item.calories }}</td>
                            <td class="py-6 text-center font-bold text-gray-500">{{ item.protein }}g</td>
                            <td class="py-6 text-center font-bold text-gray-500">{{ item.carbs }}g</td>
                            <td class="py-6 text-center font-bold text-gray-500">{{ item.fat }}g</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% else %}
            <div class="text-center py-16 bg-gray-50/50 rounded-[2rem] border-2 border-dashed border-gray-200">
                <p class="text-gray-400 font-bold">No meals logged yet.</p>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Sidebar -->
    <div class="space-y-10">
        <div class="glass-card rounded-[2.5rem] p-10">
            <h3 class="text-2xl font-black text-gray-900 mb-8 tracking-tight">Your Profile</h3>
            <div class="space-y-6">
                <div class="flex justify-between items-center p-5 rounded-2xl bg-gray-50/50">
                    <span class="text-gray-500 font-bold">Weight</span>
                    <span class="text-gray-900 font-black">{{ session.get('weight', 0) }} kg</span>
                </div>
                <div class="flex justify-between items-center p-5 rounded-2xl bg-gray-50/50">
                    <span class="text-gray-500 font-bold">Height</span>
                    <span class="text-gray-900 font-black">{{ session.get('height', 0) }} cm</span>
                </div>
                <div class="flex justify-between items-center p-5 rounded-2xl bg-gray-50/50">
                    <span class="text-gray-500 font-bold">Activity</span>
                    <span class="text-gray-900 font-black capitalize">{{ session.get('activity', 'N/A')|replace('_', ' ') }}</span>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
